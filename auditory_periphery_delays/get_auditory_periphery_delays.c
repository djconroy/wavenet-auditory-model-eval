/////////////////////////////////////////////////////
////////// START OF CODE NOT WRITTEN BY ME //////////
/////////////////////////////////////////////////////

#include <stdio.h>
#include <math.h>

#ifndef __max
#define __max(a,b) (((a) > (b))? (a): (b))
#endif

/** Calculate the delay (basilar membrane, synapse, etc. for cat) */
double delay_cat(double cf)
{
    double A0,A1,x,delay;

    A0    = 3.0;
    A1    = 12.5;
    x     = 11.9 * log10(0.80 + cf / 456.0);  /* cat mapping */
    delay = A0 * exp( -x/A1 ) * 1e-3;

    return(delay);
}

int delay_point(double cf)
{
    return __max(0,(int) ceil(delay_cat(cf)/(1 / 100e3)));
}

/////////////////////////////////////////////////////
//////////// START OF CODE WRITTEN BY ME ////////////
/////////////////////////////////////////////////////

int main(void) {
    FILE *fp = fopen("auditory_periphery_delays.txt", "w");
    double CFs[] = {125.0, 1.317568036855386e+02, 1.388788425394366e+02, 1.463858591403473e+02,
                    1.542986632407493e+02, 1.626391894524195e+02, 1.714305580500606e+02,
                    1.806971390616335e+02, 1.904646198230572e+02, 2.007600761845385e+02,
                    2.116120475659203e+02, 2.230506160691026e+02, 2.351074898668420e+02,
                    2.478160910990822e+02, 2.612116485204748e+02, 2.753312951559051e+02,
                    2.902141712347338e+02, 3.059015326890891e+02, 3.224368655169737e+02,
                    3.398660063272027e+02, 3.582372694003304e+02, 3.776015806177826e+02,
                    3.980126186304503e+02, 4.195269636580754e+02, 4.422042543318974e+02,
                    4.661073530153426e+02, 4.913025200610292e+02, 5.178595974871316e+02,
                    5.458522025822728e+02, 5.753579319756112e+02, 6.064585767378251e+02,
                    6.392403491092552e+02, 6.737941214837069e+02, 7.102156783103903e+02,
                    7.486059816122704e+02, 7.890714508568632e+02, 8.317242579552882e+02,
                    8.766826382073219e+02, 9.240712180544181e+02, 9.740213605492218e+02,
                    1.026671529499240e+03, 1.082167673294106e+03, 1.140663629480381e+03,
                    1.202321551205445e+03, 1.267312356712547e+03, 1.335816203133058e+03,
                    1.408022985889314e+03, 1.484132865092355e+03, 1.564356820393836e+03,
                    1.648917235830115e+03, 1.738048516279756e+03, 1.831997737243309e+03,
                    1.931025329746542e+03, 2.035405802265742e+03, 2.145428501676273e+03,
                    2.261398415333761e+03, 2.383637016511349e+03, 2.512483155536554e+03,
                    2.648293999098018e+03, 2.791446020325985e+03, 2.942336042390952e+03,
                    3.101382338513517e+03, 3.269025791434582e+03, 3.445731115560068e+03,
                    3.631988145168005e+03, 3.828313192248837e+03, 4.035250477743104e+03,
                    4.253373640143799e+03, 4.483287325645369e+03, 4.725628864247370e+03,
                    4.981070036458847e+03, 5.250318935501019e+03, 5.534121930170200e+03,
                    5.833265733802150e+03, 6.148579585073204e+03, 6.480937546683209e+03,
                    6.831260928292611e+03, 7.200520840429930e+03, 7.589740886449251e+03,
                    8000.0};
    int i;
    for (i = 0; i < 80; i++) {
        fprintf(fp, "%d\n", delay_point(CFs[i]));
    }
    fclose(fp);
}
